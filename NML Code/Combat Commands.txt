&CMD`ATTACK #446=$+attack *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert or(match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Attack),match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]),7,1,|)])],Attack))={@pemit %#=[prompt(Combat)] The [caplist(%0,,,L)] jutsu is not capable of Attacking.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,3,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@assert [u(#253/func`resourcecheck,%0,%1,1)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,0)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,0)])] ;@dolist/inline %1={@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[u(#253/func`damageroll,%0)])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0,^)])][u(#253/func`attackemit,%0,##)][u(#253/Func`Status)]}
&CMD`DEFEND #446=$+defend *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.};@assert hasattr(%L/Attacks`%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to defend against.};@assert eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={ @pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@pemit %#=%r[prompt(Combat)] [caplist(%0,,,L)] is not a Defensive Jutsu.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].%r};@assert [u(#253/func`resourcecheck,%0,%1,1)]={@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform [caplist(%0,,,L)]. %r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,0)])={@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,0)])][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`DefenseEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]
&CMD`DOT #446=$+DoT *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],DoT,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the DoT Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,1,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform DoT varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.33,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1.33,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,[edit(%0,%b,-)]),.5))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:DoT,^)])][u(#253/func`DoTemit,%0,##)][u(#253/Func`Status)]}
&CMD`STATUS #446=$+status:[u(#253/func`status)]
&CMD`CHARGE #446=$+Charge *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Charge,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Charge Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`Chargeresourcecheck,%0,%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Charge varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,4)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[add(u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])]),1000)],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,4)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),.75))])][setq(1,rand(4))][if(gte(add(%q1,1),3),set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,[edit(%0,%b,-)]),add(1.5,[u(#253/Func`EffectivenessMod,%0)])))]),set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,[edit(%0,%b,-)]),1))]))][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Charge,^)])][u(#253/func`ChargeEmit,%0,##,%q1)][u(#253/Func`Status)] }
&CMD`FOCUS #446=$+focus *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert isnum(%0)={@pemit %#=[prompt(Focus)] That is not a number.%r};@assert gt(%0,0)={@pemit %#=[prompt(Focus)] You have failed to focus %0 Chakra.%r};@assert gte(get(%#/Dat`Stamina`Current),[ceil(fdiv(%0,[u(#245/Func`FocusCalc)]))])={@pemit %#=[prompt(Focus)] You do not have enough Stamina.%r };@assert lte(%0,sub(get(%#/Dat`Chakra`Max),[get(%#/Dat`Chakra`Current)]))={@pemit %#=[prompt(Focus)] %0 additional Chakra is more than you can handle!%r};@assert gte([sub([get(%#/Dat`AP`Current)],3)],0)={@pemit %#=[prompt(Focus)] You do not have enough AP to Focus.};@set %#=Dat`Chakra`Current:[add([get(%#/Dat`Chakra`Current)],%0)];@set %#=Dat`Stamina`Current:[sub([get(%#/Dat`Stamina`Current)],[ceil(fdiv(%0,[u(#245/Func`FocusCalc)]))])];@set %#=Dat`AP`Current:[if([member([get(%l/list`players)],%#)],[sub([get(%#/Dat`AP`Current)],3)],[get(%#/Dat`AP`Current)])];@pemit %#=[prompt(Focus)] You have focused [u(#2105/Func`Focus,%0)] Chakra(%0) for [ceil(fdiv(%0,[u(#245/Func`FocusCalc)]))] Stamina[if([member([get(%l/list`players)],%#)],%band 3 AP.,.)] %r;@eval [setq(1,[rand(mul(%0,.5),mul(%0,2))])] ;@dolist [lcon(%L/connect)]={@pemit ##=[switch(1,[if(or(match(get(##/Dat`Merits),Sensitive,|),match(get(##/Dat`TF),Sharingan,|),match(get(##/Dat`TF),Byakugan,|)),1,0)],You estimate %N has focused [u(#2105/Func`Focus,%q1)] Chakra(%q1)!%r,[if(and(!match(get(##/Dat`Merits),Sensitive,|),!match(get(##/Dat`Flaws),Oblivious,|)),1,0)],[prompt(Focus)] You guess %N has focused [u(#2105/Func`Focus,%q1)] Chakra!%r,[if(match(get(##/Dat`Flaws),Oblivious,|),1,0)],[prompt(Focus)] You feel tingly.)]} ;@eval [u(#253/func`status)]
&CMD`DRAIN #446=$+Drain *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Drain,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Drain Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Drain varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,[edit(%0,%b,-)]),.2))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Drain,^)])][u(#253/func`DrainEmit,%0,##)][u(#253/Func`Status)]}
&CMD`TENSE #446=$+tense:@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@eval [u(#253/func`TenseRoll)][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`TenseEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)] %r;@cemit monitor-combat=[r(blah)]}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against.
&CMD`GENATTACK #446=$+Genattack *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert and(or(match(get(%#/Dat`ExpertiseList),Martial Arts*,|),match(get(%#/Dat`ExpertiseList),Armament*,|),match(get(%#/Dat`ExpertiseList),Nature Transformation:*,|),match(get(%#/Dat`ExpertiseList),Combination Element:*,|),match(get(%#/Dat`ExpertiseList),Seal Manifestation*,|)), match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|))={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,3,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Genattack varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,1)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,1)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][setq(1,[add([u(#253/func`MentalCheck,%#)],[if(match(extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),3,1,|),%#,|),ceil(mul([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),1,1,|)],.25)),0)])])][setq(2,[u(#253/func`MentalCheck,[iter(%1, [locate(%#, ##, nP)])])])][if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your Genattack [sqlite_query(Game, Select Archetype From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])][if(match(extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),3,1,|),%#,|),%benhanced by your [extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),4,1,|)] Link,)] has been successful!)][set(%#,Dat`AR:[add(u(#253/func`attackroll,%0),sub(%q1,%q2))])],[remit(%L,%r[prompt(Combat)] %N fails to perform a Gen[sqlite_query(Game, Select Archetype From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])].)][set(%#,Dat`AR:[max(add(u(#253/func`attackroll,%0),sub(%q1,%q2)),0)])])][set(%#,Dat`Damage:[ceil(mul([u(#253/func`damageroll,%0)],.8))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:GenAttack[sqlite_query(Game, Select Archetype From Templates where ID="[extract(get(%#/Dat`JutsuAttributes`%0),7,1,|)]")],^)])][u(#253/func`attackemit,%0,##)][u(#253/Func`Status)]}
&CMD`LINK #446=$+Link *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match(loc(%#),loc(*%1))={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert !hasattr([iter(%1, [locate(%#, ##, nP)])]/Dat`Link)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is already afflicted by the [extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),4,1,|)] Genjutsu Link. };@assert match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. };@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`LinkResourceCheck,%1)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),ceil(mul(4,[if(match(get(%#/Dat`Affinitylist),Yin,|),.5,1)])))={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@break !and(match(get(%#/Dat`ExpertiseList),Disruption*,|),match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|))={@eval [u(#253/func`InitiateCheck,%1)] [setq(1,[u(#253/func`MentalCheck,%#)])][setq(2,[u(#253/func`MentalCheck,[iter(%1, [locate(%#, ##, nP)])])])] [if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your Link(%q1) with the Genjutsu [caplist(%0,,,L)] has been successfully initiated! [name(*%1)] remains unaware.%r)] [u(#253/func`LinkResources,%1)][u(#253/Func`Status)][set([iter(%1, [locate(%#, ##, nP)])],Dat`Link:%q1|0|%#|%0)],[remit(%L,%r[prompt(Combat)] %N fails to Link(%q1) the Genjutsu [caplist(%0,,,L)] against [name(*%1)].)][u(#253/func`LinkResources,%1)][u(#253/Func`Status)])] };@eval [u(#253/func`InitiateCheck,%1)] [setq(1,[u(#253/func`MentalCheck,%#)])][setq(2,[u(#253/func`MentalCheck,[iter(%1, [locate(%#, ##, nP)])])])] [if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your Link(%q1) with the Genjutsu [caplist(%0,,,L)] has been successfully initiated! [name(*%1)] remains unaware.%r)] [u(#253/func`LinkResources,%1)][u(#253/Func`Status)][set([iter(%1, [locate(%#, ##, nP)])],Dat`Link:%q1|1|%#|%0)],[remit(%L,%r[prompt(Combat)] %N fails to Link(%q1) the Genjutsu [caplist(%0,,,L)] against [name(*%1)].)][u(#253/func`LinkResources,%1)][u(#253/Func`Status)])]
&CMD`SELFINFLICT #446=$+SelfInflict:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={ @pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert hasattr(%#/Dat`Link)={@remit %L=%r[prompt(Combat)] %N randomly harms [obj(%#)]self for no apparent reason.; @set %#=Dat`Vitality`Current:[sub(get(%#/Dat`Vitality`Current),[rand(500,1000)])] };@assert gte(get(%#/Dat`Vitality`Current),[if(gt([setq(2,[u(#253/func`MentalCheck,[extract(get(%#/Dat`Link),3,1,|)])])] ,[setq(1,[u(#253/func`MentalCheck,%#)])]),ceil(max(mul(get(%#/Dat`Vitality`Current),.1),mul(sub(%q2,%q1),10))),mul(get(%#/Dat`Vitality`Max),.01))])={@pemit %#=%r[prompt(Combat)] Performing this action would end in %N's death. };@remit %L=%r[prompt(Combat)] %N inflicts harm upon [obj(%#)]self, freeing [obj(%#)]self from the hold of a Genjutsu. ;@wait .0001=[pemit(%#,%r You inflict [if(gt(%q2,%q1),ceil(max(mul(get(%#/Dat`Vitality`Current),.1),mul(sub(%q2,%q1),10))),mul(get(%#/Dat`Vitality`Max),.01))] damage to yourself.%r)][set(%#,Dat`Vitality`Current:[max(Sub(get(%#/Dat`Vitality`Current),[if(gt(%q2,%q1),ceil(max(mul(get(%#/Dat`Vitality`Current),.1),mul(sub(%q2,%q1),10))),mul(get(%#/Dat`Vitality`Max),.01))]),0)])][set(%#,Dat`Link:)] [u(#253/func`status)]
&CMD`YANK #446=$^\+(yank|punch|slap|jab|tap) (.*):@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of yanking yourself.};@assert gt(get(%#/dat`Vitality`Current), 0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert gt(get(%#/Dat`AP`Current),0)={@pemit %#=%r[prompt(Combat)] You do not have enough AP to perform this action.%r};@assert match(loc(%#),loc(*%2))={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert hasattr([iter(%2, [locate(%#, ##, nP)])]/Dat`Link)={@pemit %#=%r[prompt(Combat)] You decide to %1 [name(*%2)] randomly, wasting your time.; @remit %L=%r[prompt(Combat)] %N decides to randomly %1 [name(*%2)], wasting their time and likely annoying [name(*%2)] needlessly.; @set %#=Dat`AP`Current:[max(Sub(get(%#/Dat`AP`Current),1),0)]; @eval [u(#253/Func`Status)] };@remit %L=%r[prompt(Combat)] %N %1s [name(*%2)], freeing [obj(*%2)] from the hold of a Genjutsu. [set([iter(%2, [locate(%#, ##, nP)])],Dat`Link:)]; @set %#=Dat`AP`Current:[max(Sub(get(%#/Dat`AP`Current),1),0)]; @eval [u(#253/Func`Status)]
@set #446/CMD`YANK = regexp
&CMD`KAI #446=$+Kai:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={ @pemit %#=[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break hasattr(%#/Dat`Link)={@break gte(get(%#/Dat`Chakra`Current),[if(gt([setq(2,[u(#253/func`MentalCheck,[extract(get(%#/Dat`Link),3,1,|)])])] ,[setq(1,[u(#253/func`MentalCheck,%#)])]),ceil(max(mul(get(%#/Dat`Chakra`Current),.1),mul(sub(%q2,%q1),100))),mul(get(%#/Dat`Chakra`Max),.01))])={@remit %L=%r[prompt(Combat)] %N sends a surge of chakra through [obj(%#)]self, freeing [obj(%#)]self from the hold of a Genjutsu. ;@wait .0001=[pemit(%#,%r You drain [if(gt(%q2,%q1),ceil(max(mul(get(%#/Dat`Chakra`Current),.1),mul(sub(%q2,%q1),100))),ceil(mul(get(%#/Dat`Chakra`Max),.01)))] chakra from yourself.%r)] [set(%#,Dat`Chakra`Current:[max(Sub(get(%#/Dat`Chakra`Current),[if(gt(%q2,%q1),ceil(max(mul(get(%#/Dat`Chakra`Current),.1),mul(sub(%q2,%q1),100))),ceil(mul(get(%#/Dat`Chakra`Max),.01)))]),0)])][set(%#,Dat`Link:)] [u(#253/func`status)] };@pemit %#=%r[prompt(Combat)] You do not have enough Chakra to perform Genjutsu Kai. };@remit %L=%r[prompt(Combat)] %N suddenly wastes a bit of chakra[if(lt(get(%#/Dat`Chakra`Current),1000),%bdamaging [poss(%#)] own Chakra network!,.)]; @set %#=Dat`Chakra`Current:[if(lt(get(%#/Dat`Chakra`Current),1000),[set(%#,Dat`SpiritualEnergy`Current:[max(sub(get(%#/Dat`SpiritualEnergy`Current),sub(1000,get(%#/Dat`Chakra`Current))),0)])][set(%#,Dat`Chakra`Current:0)],[max(sub(get(%#/Dat`Chakra`Current),1000),0)])]; @wait .01=@eval [u(#253/func`status)]
&CMD`COUNTERLINK #446=$+CounterLink *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert hasattr(%#/Dat`Link)={@pemit %#=%r[prompt(Combat)] You are not Genjutsu Linked.};@assert nearby(%#,[iter([extract(get(%#/Dat`Link),3,1,|)], [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert !hasattr([extract(get(%#/Dat`Link),3,1,|)]/Dat`Link)={@pemit %#=%r[prompt(Combat)] [name(*[extract(get(%#/Dat`Link),3,1,|)])] is already afflicted by a Genjutsu Link. };@assert match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. };@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`LinkResourceCheck,[extract(get(%#/Dat`Link),3,1,|)])]={@pemit %#=[Prompt(Combat)] You do not have the resources to Counter Link with [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),ceil(mul(3,[if(match(get(%#/Dat`Affinitylist),Yin,|),.5,1)])))={@pemit %#=[Prompt(Combat)] You do not have enough AP to Counter Link with [caplist(%0,,,L)].%r};@assert hasattr(%#/Dat`Link)={@pemit %#=[Prompt(Combat)] You can only Counter Link when there is a Link already on you.};@break !and(match(get(%#/Dat`ExpertiseList),Disruption*,|),match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|))={@eval [u(#253/func`InitiateCheck,[extract(get(%#/Dat`Link),3,1,|)])] [setq(1,[u(#253/func`MentalCheck,%#)])][setq(2,[extract(get(%#/Dat`Link),1,1,|)])] [if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your [caplist(%0,,,L)] Counter Link(%q1) against [name(*[extract(get(%#/Dat`Link),3,1,|)])]'s [caplist([extract(get(%#/Dat`Link),4,1,|)])] Link(%q2) has been successfully woven in to their Genjutsu! [name(*[extract(get(%#/Dat`Link),3,1,|)])] remains unaware.%r)] [u(#253/func`LinkResources,[extract(get(%#/Dat`Link),3,1,|)])][u(#253/Func`Status)][set([extract(get(%#/Dat`Link),3,1,|)],Dat`Link:%q1|0|%#|%0)][set(%#,Dat`Link:)],[pemit(%# [extract(get(%#/Dat`Link),3,1,|)],%r[prompt(Combat)] %N fails to Counter Link(%q1) [name(*[extract(get(%#/Dat`Link),3,1,|)])]'s [caplist([extract(get(%#/Dat`Link),4,1,|)])].)][u(#253/func`LinkResources,[extract(get(%#/Dat`Link),3,1,|)])][set(%#,Dat`Link:[replace(get(%#/Dat`Link),1,[ceil(mul([extract(get(%#/Dat`Link),1,1,|)],fdiv(rand(7,9),10)))],|)])][u(#253/Func`Status)])] };@eval [u(#253/func`InitiateCheck,[extract(get(%#/Dat`Link),3,1,|)])] [setq(1,[u(#253/func`MentalCheck,%#)])][setq(2,[extract(get(%#/Dat`Link),1,1,|)])] [if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your [caplist(%0,,,L)] Counter Link(%q1) against [name(*[extract(get(%#/Dat`Link),3,1,|)])]'s [caplist([extract(get(%#/Dat`Link),4,1,|)])] Link(%q2) has been successfully woven in to their Genjutsu! [name(*[extract(get(%#/Dat`Link),3,1,|)])] remains unaware.%r)] [u(#253/func`LinkResources,[extract(get(%#/Dat`Link),3,1,|)])][u(#253/Func`Status)][set([extract(get(%#/Dat`Link),3,1,|)],Dat`Link:%q1|1|%#|%0)][set(%#,Dat`Link:)],[pemit(%# [extract(get(%#/Dat`Link),3,1,|)],%r[prompt(Combat)] %N fails to Counter Link(%q1) [name(*[extract(get(%#/Dat`Link),3,1,|)])]'s [caplist([extract(get(%#/Dat`Link),4,1,|)])].)][u(#253/func`LinkResources,[extract(get(%#/Dat`Link),3,1,|)])][set(%#,Dat`Link:[replace(get(%#/Dat`Link),1,[ceil(mul([extract(get(%#/Dat`Link),1,1,|)],fdiv(rand(7,9),10)))],|)])][u(#253/Func`Status)])]
&CMD`EXHAUST #446=$+Exhaust *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@break gt(get(%#/dat`Vitality`Current),0)={@break [member([get(%l/list`players)],%#)]={@break eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@break match(loc(%#),loc(*%1))={@break and(match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|),match(get(%#/Dat`ExpertiseList),Exhaust*,|))={@break [u(#253/func`ExhaustResourceCheck)]={@break gte(get(%#/Dat`AP`Current),ceil(mul(6,[if(match(get(%#/Dat`Affinitylist),Yin,|),.5,1)])))={@eval [u(#253/func`InitiateCheck,%1)] [setq(1,[add(ceil(mul([u(#253/func`MentalCheck,%#)],.75)),[if(match(extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),3,1,|),%#,|),ceil(mul([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),1,1,|)],.25)),0)])])][setq(2,[u(#253/func`MentalCheck,[iter(%1, [locate(%#, ##, nP)])])])] [if(gt(%q1,%q2),[setq(3,[min(mul(sub(%q1,%q2),250),ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`PhysicalEnergy`Total),.18)))])][setq(4,[min(mul(sub(%q1,%q2),300),ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Stamina`Total),.18)))])][pemit(%#,%r[prompt(Combat)] Your Genjutsu(%q1) [caplist(%0,,,L)][if(match(extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),3,1,|),%#,|),%benhanced by your [extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Link),4,1,|)] Link,)] has exhausted [name(*%1)](%q2) eliminating [add(%q4,ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Stamina`Max),.1)))] Stamina and [add(%q3,ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`PhysicalEnergy`Max),.1)))] Physical Energy!)] [pemit([iter(%1, [locate(%#, ##, nP)])],%r[prompt(Combat)] You suddenly feel physically exhausted due to %N's Genjutsu(%q1) [caplist(%0,,,L)].)] [u(#253/func`ExhaustResources,%1)][set([iter(%1, [locate(%#, ##, nP)])],Dat`PhysicalEnergy`Current:[max(0,sub(get([iter(%1, [locate(%#, ##, nP)])]/Dat`PhysicalEnergy`Current),add(%q3,ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`PhysicalEnergy`Max),.1)))))])][set([iter(%1, [locate(%#, ##, nP)])],Dat`Stamina`Current:[max(0,sub(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Stamina`Current),add(%q4,ceil(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Stamina`Max),.1)))))])][set([iter(%1, [locate(%#, ##, nP)])],Dat`Stamina`Max:[max(0,[u(#245/func`StaminaCalcReset,%1)])])][u(#253/Func`Status)],[remit(%L,%r[prompt(Combat)] %N fails to Exhaust [name(*%1)](%q2) with the Genjutsu(%q1) [caplist(%0,,,L)].)][u(#253/func`ExhaustResources,%1)][u(#253/Func`Status)])] };@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%0,,,L)].%r};@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. };@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r%r[prompt(Combat)] You are not in order.%r}; @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r
&CMD`HEAL #446=$+heal *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of healing yourself without regeneration.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@break gt(get(%#/dat`Vitality`Current),0)={@break [member([get(%l/list`players)],%#)]={@break eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@break match(loc(%#),loc(*%1))={@break lt(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Current),get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Max))={@break match(get(%#/Dat`ExpertiseList),Medical Knowledge*,|)={@break [u(#253/func`Healresourcecheck,[iter(%1, [locate(%#, ##, nP)])])]={@break gte(get(%#/Dat`AP`Current),ceil(mul(add(6,[if([extract(get(%#/Dat`Link),2,1,|)],1)]),[if([match(get(%#/Dat`AffinityList),Yang,|)],.75,1)])))={@eval [u(#253/func`InitiateCheck,%1)][u(#253/func`HealResources,[iter(%1, [locate(%#, ##, nP)])])][u(#253/func`healemit,%0,%1)][set([iter(%1, [locate(%#, ##, nP)])],Dat`Vitality`Current:[add(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Current),[if(lte(mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Total),.2),[sub(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Max),get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Current))]),mul(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Total),.2),[sub(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Max),get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Current))])])])][u(#253/Func`Status)]};@pemit %#=[Prompt(Combat)] You do not have enough AP to perform Healing Jutsu.%r};@pemit %#=[Prompt(Combat)] You do not have the resources to perform Healing jutsu.%r};@pemit %#=[Prompt(Combat)] You do not know how to perform Healing jutsu.%r};@pemit %#=%r[prompt(Combat)] [name(*%1)] is already at full Vitality. };@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r%r[prompt(Combat)] You are not in order.%r}; @pemit %#=%r[prompt(Combat)] You are dead and can no longer heal.%r
&CMD`STEALTH #446=$+Stealth/* *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Stealth.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert [or([and(or(match(get(%#/Dat`ExpertiseList),Nature Transformation:*,|),match(get(%#/Dat`ExpertiseList),Combination Element:*,|),match(get(%#/Dat`ExpertiseList),Seal Manifestation*,|)),match(Ninjutsu,%0))],[and(match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|),match(Genjutsu,%0))],[match(Taijutsu,%0)])]={@pemit %#=[Prompt(Combat)] You do not have the Category training needed to perform this action.%r};@assert gte(get(%#/Dat`AP`Current),6)={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%1)].%r};@assert [u(#253/func`StealthResourceCheck,%0 ##)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%1)].%r};@dolist/inline [remove(lcon(%L/connect),%#)]={@assert nearby(%l,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@eval [set(%#,Dat`AP`Current:[sub(get(%#/Dat`AP`Current),6)])] [u(#253/FUNC`StealthRESOURCES,%0)];@dolist/inline [remove(lcon(%L/connect),%#)]={@assert !hasattr([locate(%#, ##, nP)]/Dat`PerceptionCheck)={@pemit %#=%r[prompt(Combat)] Though you make the attempt, you are already hidden from [name(##)].; @wait .01=[u(#253/Func`Status)]};@eval [setq(1,[u(#253/func`StealthCheck,%#,%0)])][setq(2,[u(#253/func`PerceptionCheck,[locate(%#, ##, nP)])])] [if(gte(%q1,%q2),[set([locate(%#, ##, nP)],Dat`PerceptionCheck:%q1|[caplist(%1)]|%#)][pemit(%#,[prompt(Combat)] You have successfully hidden from [name(*##)] with [caplist(%1,,,L)]!)],[pemit(%#,[Prompt(Combat)] You have failed to hide from [name(##)].)][pemit(##,[prompt(Combat)] You notice %N attempting to hide with [caplist(%1,,,L)]!)])][u(#253/Func`Status)]}
&CMD`PERCEPTION #446=$+Perception/* *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Perceive.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert or(and(or(match(get(%#/Dat`ExpertiseList),Nature Transformation:*,|),match(get(%#/Dat`ExpertiseList),Combination Element:*,|),match(get(%#/Dat`ExpertiseList),Seal Manifestation*,|)),match(Ninjutsu,%0)),and(match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|),match(Genjutsu,%0)),match(Taijutsu,%0))={@pemit %#=[Prompt(Combat)] You do not have the Category training needed to perform this action.%r };@assert [u(#253/func`PerceptionResourceCheck,%0)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%1)].%r};@assert gte(get(%#/Dat`AP`Current),2)={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%1)].%r};@eval [u(#253/FUNC`PerceptionRESOURCES,%0)];@dolist/inline [remove(lcon(%L/connect),%#)]={@assert match(loc(%#),loc(##))={@pemit %#=%r[prompt(Combat)] [Name(*##)] is not in the same area as you. %r};@assert match([extract(get(%#/Dat`PerceptionCheck),3,1,|)],[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] [name(##)] is not hidden from you.};@eval [setq(1,[u(#253/func`PerceptionCheck,%#)])][setq(2,[extract(get(%#/Dat`PerceptionCheck),1,1,|)])] [if(gte(%q1,%q2),[remit(%L,[prompt(Combat)] %N has discovered [name(##)] with [caplist(%1,,,L)]!)][set(%#,Dat`PerceptionCheck:)],[pemit(%#,[prompt(Combat)] [name(##)] continues to evade your perception!)])][u(#253/Func`Status)]}
&CMD`ABSORB #446=$+Absorb *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Absorb,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Absorb Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Absorb varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[Locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,[edit(%0,%b,-)]),.1))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Absorb,^)])][u(#253/func`AbsorbEmit,%0,##)][u(#253/Func`Status)]}
&CMD`FEINT #446=$+Feint *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control.  };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([extract(extract(get(%L/Attacks`[iter(%1, [locate(%#, ##, nP)])]),[words(get(%L/Attacks`[iter(%1, [locate(%#, ##, nP)])]),^)],1,^),1,1,:)],%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to Feint with against that target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Feint,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Feint Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Feint varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,1)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,1)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[Locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%L,Attacks`[locate(%#, ##, nP)]:[replace([get(%l/attacks`[locate(%#, ##, nP)])], -1, [replace([extract(get(%L/Attacks`[locate(%#, ##, nP)]),[words(get(%L/Attacks`[locate(%#, ##, nP)]),^)],1,^)],4,[ceil(mul(extract(extract(get(%L/Attacks`[locate(%#, ##, nP)]),[words(get(%L/Attacks`[locate(%#, ##, nP)]),^)],1,^),4,1,:),add(1.05,u(#253/Func`EffectivenessMod,%0))))],:)], ^)])][u(#253/func`FeintEmit,%0,##)][u(#253/Func`Status)]}
&CMD`FLURRY #446=$+Flurry *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Flurry,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Flurry Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Flurry varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r}; @dolist/inline %1={@assert match(loc(%#),loc([locate(%#, ##, nP)]))={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][iter([lnum([rand(2,4)])],[set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),add(.75,[u(#253/Func`EffectivenessMod,%0)])))])] [ceil(mul([set(%#,Dat`Damage:[u(#253/func`damageroll,%0)])],.9))][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Flurry,^)])][u(#253/func`FlurryEmit,%0,##)]%r;@cemit monitor-combat=[r(blah)])]};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])][u(#253/Func`Status)]
&CMD`BARRAGE #446=$+Barrage *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Barrage,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Barrage Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Barrage varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,4)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,4)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),.9))])] [set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,%0),add(.75,[fdiv(u(#253/Func`EffectivenessMod,%0),.1)])))])][iter([lnum([rand(2,4)])],[set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Barrage,^)])][u(#253/func`BarrageEmit,%0,##)]%r;@cemit monitor-combat=[r(blah)])][u(#253/Func`Status)]}
&CMD`SACRIFICE #446=$+Sacrifice *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert hasattr(%L/Attacks`[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] There are no attacks to defend against.};@assert match(get(%#/Dat`ExpertiseList),Sacrifice*,|)={@pemit %#=%r[prompt(Combat)] You are not trained to utilize the Sacrifice Special Action properly.};@eval [u(#253/func`TenseRoll)][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`SacrificeEmit,%0)][set(%L,Attacks`[iter(%0, [locate(%#, ##, nP)])]:[ldelete(get(%L/Attacks`[iter(%0, [locate(%#, ##, nP)])]),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)] %r;@cemit monitor-combat=[r(blah)]
&CMD`TARGETED #446=$+Targeted *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Targeted,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Targeted Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Targeted varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[Locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),1.1))])] [set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,%0),.8))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Targeted,^)])][u(#253/func`TargetedEmit,%0,##)]%r;@cemit monitor-combat=[r(blah)][u(#253/Func`Status)]}
&CMD`POWERFUL #446=$+Powerful *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Powerful,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Powerful Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Powerful varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[Locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),.8))])] [set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,%0),[add(1.2,[if(and(hasattr(%#/Dat`BodyMod),match(Akimichi,[get(%#/Dat`Clan)],|)),add(fdiv([after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),Body Mod*,|)],1,|),^,1)],10),.1),0)])]))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:Powerful,^)])][u(#253/func`PowerfulEmit,%0,##)]%r;@cemit monitor-combat=[r(blah)][u(#253/Func`Status)]}
&CMD`COPY #446=$+Copy *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of copying your own jutsu.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert nearby(%#,[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=[prompt(Game)] The character you are trying to Copy from is not present in the room.};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Copy,|)={@pemit %#=[prompt(Combat)] You do not have an appropriate Specialty needed to Copy.};@assert !hasattr(%#/Dat`JutsuAttributes`[edit(%1,%b,-)])={@pemit %#=[prompt(Game)] You have already copied the [caplist(%1,,,L)] jutsu.};@assert [if(match(get(%#/Dat`TF),Kokuuzou,|),1,[u(#1215/Func`ExpertSpecCopy,%1,%0)])]={@pemit %#=[prompt(Game)] You do not have the Specialties training necessary to copy the [caplist(%1,,,L)] jutsu.};@assert if(match(sqlite_query(Game, select Author from Templates where ID="[elements(get([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]"),General),1,match(sqlite_query(Game, select Author from Templates where ID="[elements(get([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]"),get(%#/Dat`Clan),|))={@pemit %#=[prompt(Game)] You are not part of a clan capable of copying the [caplist(%0,,,L)] jutsu. };@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert gte(get(%#/Dat`AP`Current),4)={@pemit %#=[prompt(Combat)] You do not have enough AP to Copy a jutsu.};@assert gte(get(%#/Dat`Stamina`Current),ceil(mul(get(%#/Dat`Stamina`Total),.01)))={@pemit %#=[prompt(Combat)] You do not have enough Stamina to Copy a jutsu.};@set %#=Dat`AP`Current:[sub(get(%#/Dat`AP`Current),4)];@set %#=Dat`Stamina`Current:[sub(get(%#/Dat`Stamina`Current),ceil(mul(get(%#/Dat`Stamina`Total),.01)))];@IFELSE match(get(%#/Dat`TFList),Sharingan,|)={@IF match(get(%#/Dat`TF),Sharingan,|)=@eval [if(eq(rand(3),2),[if([hasattr([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])],[set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[get([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])])][set(%#,Dat`CopyList:[insert(get(%#/Dat`CopyList),-1,[caplist(%1)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),14,6,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),13,Copy,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),15,0,|)])][remit(%L,[prompt(Copy)] %N's Sharingan [switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),Copy*,|)],1,|),^),0,I,1,II,2,III)] swirls rapidly around [poss(%#)] pupil as it successfully copies [name(*%0)]'s [caplist(%1)]!)],[pemit(%#,[Prompt(Copy)] [name(*%0)] does not have [caplist(%1)].)])],[Remit(%L,[prompt(Copy)] %N's Sharingan [switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),Copy*,|)],1,|),^),0,I,1,II,2,III)] loses focus and fails to copy [name(*%0)]'s [caplist(%1,,,L)].)])],@pemit %#=[prompt(Copy)] You do not have Sharingan activated.};@IFELSE match(get(%#/Dat`TFList),Kokuuzou,|)={@IF match(get(%#/Dat`TF),Kokuuzou,|)=@eval [if(eq(rand(3),2),[if([hasattr([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])],[set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[get([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),1,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),2,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),3,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),4,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),5,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),6,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),14,1,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),15,0,|)])][remit(%L,[prompt(Copy)] %N's [switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),Copy*,|)],1,|),^),0,vacuuous eyes fall upon,1,tenebrous gaze focuses on,2,abyssal glare divine)] [name(*%0)]%, instantly discerning the nature of their [caplist(%1)] jutsu!)],[pemit(%#,[Prompt(Copy)] [name(*%0)] does not have [caplist(%1)].)])],[Remit(%L,[prompt(Copy)] %N's [switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),Copy*,|)],1,|),^),0,vacuuous eyes fail,1,tenebrous gaze fails,2,abyssal glare fails)] to interpret the complexities of [name(*%0)]'s [caplist(%1,,,L)].)])],@pemit %#=[prompt(Copy)] You do not have Kokuuzou activated.};@IFELSE and([match(get(%#/Dat`ExpertiseList),Copy*,|)],[!match([get(%#/Dat`TF)],Sharingan,|)],[!match([get(%#/Dat`TF)],Kokuuzou,|)])={@eval [if(eq(rand(3),2),[if([hasattr([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])],[set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[get([iter(%0, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%1,%b,-)])])][set(%#,Dat`CopyList:[insert(get(%#/Dat`CopyList),-1,[caplist(%1)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),1,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),2,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),3,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),4,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),5,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),6,[switch(after(extract(get(%#/Dat`ExpertiseList),[match(get(%#/Dat`ExpertiseList),[switch([sqlite_query(Game, Select Archetype From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")],Taijutsu,Martial Arts*,Bukijutsu,Armament*,Ninjutsu,Nature Transformation: [sqlite_query(Game, Select Type From Templates Where ID="[elements(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,|)]")]*,Seal,Seal Manifestation*,Calligraphy,Calligraphy Conjuration)],|)],1,|),^),0,5,1,6,2,7)],|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),13,Copy,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),14,6,|)])][set(%#,Dat`JutsuAttributes`[edit(%1,%b,-)]:[replace(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),15,0,|)])][remit(%L,[prompt(Copy)] %N's concerted observations of [name(*%0)] has succeeded in allowing them to copy the [caplist(%1)] jutsu!)],[pemit(%#,[Prompt(Copy)] [name(*%0)] does not have [caplist(%1)].)])],[remit(%L,[prompt(Copy)] %N's concerted observations of [name(*%0)] has failed to copy the [caplist(%1)] jutsu.)])],@pemit %#=[prompt(Copy)] You do not have an appropriate Transformation activated.}
&CMD`SCROLLCREATE #446=$+Scroll/Create *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert gt([extract(get(%#/Dat`ScrollInv),1,1,|)],[extract(get(%#/Dat`ScrollInv),2,1,|)])={@pemit %#=[prompt(Game)] You already have the maximum amount of scrolls that you can carry.}; @assert match(get(%#/Dat`ExpertiseList),Calligraphy Conjuration*,|)={@pemit %#=[prompt(Game)] You do not have the Calligraphy Conjuration Specialty and thus cannot create Scrolls. }; @assert hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)])={@pemit %#=[prompt(Game)] You do not possess the jutsu you are trying to create a scroll for.}; @assert match([sqlite_query(Game, Select Category from Templates Where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Ninjutsu)={@pemit %#=[prompt(Game)] You may only seal Ninjutsu techniques in to scrolls.}; @assert gte(get(%#/Dat`Stamina`Current),[switch([sqlite_query(Game, Select Rank from Templates Where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],E,100,D,200,C,400,B,600,A,800,S,1000)])={@pemit %#=[prompt(Game)] You do not have enough Stamina to create the [caplist(%0,,,L)] Scroll.}; @assert gte(get(%#/Dat`Chakra`Current),[switch([sqlite_query(Game, Select Rank from Templates Where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],E,1500,D,3000,C,6000,B,10000,A,15000,S,25000)])={@pemit %#=[prompt(Game)] You do not have enough Chakra to create the [caplist(%0,,,L)] Scroll.}; @assert [if([member([get(%l/list`players)],%#)],gte(get(%#/Dat`AP`Current),6),1)]={@pemit %#=[prompt(Game)] You do not have enough AP to create the [caplist(%0,,,L)] Scroll.}; @set %#=Dat`ScrollInv:[replace(get(%#/dat`ScrollInv),2,[add([extract(get(%#/Dat`ScrollInv),2,1,|)],1)],|)]; @set %#=Dat`ScrollInv:[insert(get(%#/dat`ScrollInv),-1,%0,|)]; @set %#=Dat`Stamina`Current:[sub(get(%#/Dat`Stamina`Current),[switch([sqlite_query(Game, Select Rank from Templates Where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],E,100,D,200,C,400,B,600,A,800,S,1000)])]; @set %#=Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),[switch([sqlite_query(Game, Select Rank from Templates Where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],E,1500,D,3000,C,6000,B,10000,A,15000,S,25000)])];@eval [if([member([get(%l/list`players)],%#)],[set(%#,Dat`AP`Current:[sub(get(%#/Dat`AP`Current),6)])])] ;@pemit %#=[prompt(Game)] You have successfully sealed the [caplist(%0,,,L)] jutsu onto a scroll!; @remit %L=[prompt(Game)] %N has successfully created a Scroll!
&CMD`SCROLL #446=$+Scroll *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of using your own scrolls against yourself.};@assert match([extract(get(%#/Dat`ScrollInv),3,10,|)],%0,|)={@pemit %#=%r[prompt(Combat)] You do not possess the [caplist(%0)] Scroll.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match(extract(get(%#/Dat`ScrollInv),3,10,|),%0,|)={@pemit %#=[Prompt(Combat)] You do not have the [caplist(%0)] Scroll in your inventory.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`ScrollResourceCheck,%1)]={@pemit %#=[Prompt(Combat)] You do not have the resources to unseal the [caplist(%0)] Scroll.%r};@assert gte(get(%#/Dat`AP`Current),add(3,[if([extract(get(%#/Dat`Link),2,1,|)],1)][if(gt(words(%1),1),3,0)]))={@pemit %#=[Prompt(Combat)] You do not have enough AP to unseal the [caplist(%0)] Scroll.%r};@eval [u(#253/func`Scrollresources,%1)] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[u(#253/func`damageroll,%0)])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:,^)])][u(#253/func`ScrollEmit,%0,##)][pemit(%#,[prompt(Combat)] You have used a [grab(get(%#/dat`ScrollInv),%0,|)] Scroll. You now have [sub([extract(get(%#/Dat`ScrollInv),2,1,|)],1)] Scrolls remaining.)][set(%#,Dat`ScrollInv:[replace(get(%#/dat`ScrollInv),2,[sub([extract(get(%#/Dat`ScrollInv),2,1,|)],1)],|)])][set(%#,Dat`ScrollInv:[remove(get(%#/dat`ScrollInv),[grab(get(%#/dat`ScrollInv),%0,|)],|)])][u(#253/Func`Status)]}
&CMD`TFACTIVATE #446=$+TF *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@assert !hasattr(%#/Dat`TF)={@pemit %#=[prompt(Combat)] The [get(%#/Dat`TF)] Transformation is already active.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match(get(%#/Dat`TFList),%0,|)={@pemit %#=[Prompt(Combat)] You do not know how to perform the [caplist(%0)] Transformation.};@assert [u(#253/func`TFresourcecheck,%0,%1)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%0)].%r};@assert gte(get(%#/Dat`AP`Current),[sub(3,[If(eq(get(%#/Dat`TFRank`[edit(get(%#/Dat`TF),%b,-)]),2),1,[if(eq(get(%#/Dat`TFRank`[edit(get(%#/Dat`TF),%b,-)]),3),2,0)])])])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0)].%r};@set %#=Dat`TF:[grab(get(%#/Dat`TFList),%0,|)];@remit %L=[prompt(Combat)] %N activates [poss(%#)] [grab(get(%#/Dat`TFList),%0,|)] Transformation!; @eval [u(#253/func`TFResources)][set(%#,Dat`AP`Current:[sub(get(%#/Dat`AP`Current),[sub(3,[If(eq(get(%#/Dat`TFRank`[edit(get(%#/Dat`TF),%b,-)]),2),1,[if(eq(get(%#/Dat`TFRank`[edit(get(%#/Dat`TF),%b,-)]),3),2,0)])])])])][u(#253/Func`Status)]
&CMD`TFDEACTIVATE #446=$+TF/revert:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@assert hasattr(%#/Dat`TF)={@pemit %#=[prompt(Game)] You do not currently have an active Transformation.}; @pemit %#=[prompt(Game)] You have reverted from your [get(%#/Dat`TF)] Transformation.; @set %#=Dat`TF:
&CMD`ESCAPE #446=$+escape *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of escaping yourself existentially or other wise.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer escape.%r};@assert gte(get(%#/Dat`AP`Current),3)={@pemit %#=[prompt(Combat)] You do not have enough AP to Escape.};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@dolist/inline %0={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@set %#=Dat`AP`Current:[sub(get(%#/Dat`AP`Current),3)];@dolist/inline [iter(%0, [locate(%#, ##, nP)])]={If(gte([add(10,[dice(1,20)],[IF(match(extract(get([locate(%#, ##, nP)]/Dat`PerceptionCheck),3,1,|),%#,|),10)],[IF(match(get(%#/Dat`Merits),Vigorous,|),2)],[IF(match(get(%#/Dat`Merits),Rapid Recovery,|),2)],[IF(match(get(%#/Dat`Merits),Prodigy,|),1)],[IF(match(get(%#/Dat`Merits),Genius,|),3)],[IF(match(get(%#/Dat`Flaws),Enervated,|),-2)],[IF(match(get(%#/Dat`Flaws),Slow Recovery,|),-2)],[IF(match(get(%#/Dat`Flaws),Late Bloomer,|),-1)],[IF(match(get(%#/Dat`Flaws),Impaired,|),-3)],get(%#/Dat`Tier))],[add([extract(get([locate(%#, ##, nP)]/Dat`RPSkills),[match(get(#244/Dat`RPSkills),Pursuit,|)],1,|)],[dice(1,20)],[IF(match(get([locate(%#, ##, nP)]/Dat`Merits),Vigorous,|),2)],[IF(match(get([locate(%#, ##, nP)]/Dat`Merits),Rapid Recovery,|),2)],[IF(match(get([locate(%#, ##, nP)]/Dat`Merits),Prodigy,|),1)],[IF(match(get([locate(%#, ##, nP)]/Dat`Merits),Genius,|),3)],[IF(match(get([locate(%#, ##, nP)]/Dat`Flaws),Enervated,|),-2)],[IF(match(get([locate(%#, ##, nP)]/Dat`Flaws),Slow Recovery,|),-2)],[IF(match(get([locate(%#, ##, nP)]/Dat`Flaws),Late Bloomer,|),-1)],[IF(match(get([locate(%#, ##, nP)]/Dat`Flaws),Impaired,|),-3)],get([locate(%#, ##, nP)]/Dat`Tier))]),[remit(%L,[prompt(Combat)] [ansi(hc,%N)] has successfully escaped from [ansi(hr,name(*##))]!%r)],[remit(%L,[prompt(Combat)] [ansi(hc,%N)] was unable to escape [ansi(hr,caplist(##))]'s pursuit!%r)])};@eval [u(#253/Func`Status)]
&CMD`COUNTER #446=$^\+counter ([A-Za-z ]+)(=(.*))?$:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)]")],Counter,~)={ @pemit %#=%r[prompt(Combat)] The %1 jutsu isn't capable of utilizing the Counter Special Action.};@assert if(gt(strlen(%3),2),match(Powerful|Targeted|Drain|Absorb|DoT|Disrupt,%3,|),1)={@pemit %#= %r[prompt(Combat)] You cannot use the %3 Special Action as a Counter.};@assert if(gt(strlen(%3),2),match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)]")],%3,~),1)={@pemit %#=%r[prompt(Combat)] The %1 jutsu isn't capable of utilizing the [caplist(%3)] Special Action.};@break match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@pemit %#=%r[prompt(Combat)] You cannot Counter against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.};@break !hasattr(%L/Attacks`%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to Counter against. };@break !eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={ @pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break !match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)])],Attack,:)={@pemit %#=%r[prompt(Combat)] [caplist(%1)] is not a Offensive Jutsu.};@break !or(hasattr(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%1,%b,-)]))={@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%1)].%r};@assert [u(#253/func`CounterResourceCheck,%1,%3)]={@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform [caplist(%1)]. %r};@assert gte(get(%#/Dat`AP`Current),max(1,add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%1,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),[ceil(sub(add(1,[if(gte(strlen(%3),2),3,0)]),mul(add(1,[if(gte(strlen(%3),2),3,0)]),[u(#253/func`adaptabilitymod,[edit(%1,%b,-)])])))])))={@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@eval [u(#253/func`defenseroll,%1,[extract(get(%L/Attacks`%#),2,1,:)],%3)][set(%#,Dat`Damage:[u(#253/func`Damageroll,%1)])][u(#253/func`CounterResources,[edit(%1,%b,-)],%3)][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`CounterEmit,[edit(%1,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)],%3)][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]
@set #446/CMD`COUNTER = regexp
&CMD`CLASH #446=$^\+Clash ([A-Za-z ]+)(=(.*))?$:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)]")],Clash,~)={ @pemit %#=%r[prompt(Combat)] The %1 jutsu isn't capable of utilizing the Clash Special Action.};@assert if(gt(strlen(%3),2),match(Powerful|Targeted|Drain|Absorb|DoT|Disrupt,%3,|),1)={@pemit %#= %r[prompt(Combat)] You cannot use the %3 Special Action as a Clash.};@assert if(gt(strlen(%3),2),match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)]")],%3,~),1)={@pemit %#=%r[prompt(Combat)] The %1 jutsu isn't capable of utilizing the [caplist(%3)] Special Action.};@break match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@pemit %#=%r[prompt(Combat)] You cannot Clash against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.};@break !hasattr(%L/Attacks`%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to Clash against. };@break !eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={ @pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break !match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),7,1,|)])],Attack,:)={@pemit %#=%r[prompt(Combat)] [caplist(%1)] is not a Offensive Jutsu.};@break !or(hasattr(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%1,%b,-)]))={@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%1)].%r};@assert [u(#253/func`ClashResourceCheck)]={@pemit %#=%r[prompt(Combat)] You are not strained enough to perform [caplist(%1)] as a Clash. %r};@assert ={;@assert gt(get(%#/Dat`AP`Current),0)={@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@eval [u(#253/func`defenseroll,[edit(%1,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)],%3)][set(%#,Dat`DR:[mul(get(%#/Dat`DR),1)])][u(#253/func`Damageroll,%1)][u(#253/func`ClashResources,[edit(%1,%b,-)],%3)][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`ClashEmit,[edit(%1,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)],%3)][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]
@set #446/CMD`CLASH = regexp
&CMD`EVADE #446=$+Evade *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Evade,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Evade Special Action.};@break !match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@break match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@break or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@break [u(#253/func`resourcecheck,%0,%1,2.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@break gte(get(%#/Dat`AP`Current),add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),2))={@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%#,Dat`Dr:[ceil(mul(get(%#/Dat`DR),1.2))])][u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`EvadeEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]};@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform [caplist(%0)]. %r};@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0)].%r};@pemit %#=%r[prompt(Combat)] [caplist(%0)] is not a Defensive Jutsu.}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against. }; @pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.
&CMD`BLOCK #446=$+Block *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Block,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Block Special Action.};@break !match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@break match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@break or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@break [u(#253/func`resourcecheck,%0,%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@break gte(get(%#/Dat`AP`Current),add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),1))={@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%#,Dat`Dr:[ceil(mul(get(%#/Dat`DR),.75))])][u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,1)])][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`BlockEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]};@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform [caplist(%0)]. %r};@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0)].%r};@pemit %#=%r[prompt(Combat)] [caplist(%0)] is not a Defensive Jutsu.}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against. }; @pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.
&CMD`REFLECTION #446=$+Reflection *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Reflection,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Reflection Special Action.};@break match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@pemit %#=%r[prompt(Combat)] You cannot Reflect a Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.};@break !hasattr(%L/Attacks`%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to Reflection against. };@break !eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={ @pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break !match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@pemit %#=%r[prompt(Combat)] [caplist(%0)] is not a Defensive Jutsu.};@break !or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0)].%r};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=%r[prompt(Combat)] You do not have enough resources to Reflect with [caplist(%0)]. %r};@assert gte(get(%#/Dat`AP`Current),ceil(add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])],3)))={@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,3)])][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`ReflectionEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]
&CMD`REGEN #446=$+Regen:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break gt(get(%#/dat`Vitality`Current),0)={@break [member([get(%l/list`players)],%#)]={@break eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@break lt(get(%#/Dat`Vitality`Current),get(%#/Dat`Vitality`Max))={@break [match(get(%#/Dat`ExpertiseList),Regeneration*,|)]={@break [u(#253/func`RegenResourceCheck)]={@break gte(get(%#/Dat`AP`Current),ceil(mul(add(4,[if([extract(get(%#/Dat`Link),2,1,|)],1)]),[if([match(get(%#/Dat`AffinityList),Yang,|)],.75,1)])))={@eval [u(#253/func`RegenResources)][u(#253/func`RegenEmit)][set(%#,Dat`Vitality`Current:[add(get(%#/Dat`Vitality`Current),[if(lte(mul(get(%#/Dat`Vitality`Total),.3),[sub(get(%#/Dat`Vitality`Max),get(%#/Dat`Vitality`Current))]),mul(get(%#/Dat`Vitality`Total),.3),[sub(get(%#/Dat`Vitality`Max),get(%#/Dat`Vitality`Current))])])])][u(#253/Func`Status)]};@pemit %#=[Prompt(Combat)] You do not have enough AP to perform Regeneration.%r};@pemit %#=[Prompt(Combat)] You do not have the resources to perform Healing jutsu.%r};@pemit %#=[Prompt(Combat)] You are not able to Regenerate.%r};@pemit %#=%r[prompt(Combat)] You are already at full Vitality. };@pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r%r[prompt(Combat)] You are not in order.%r}; @pemit %#=%r[prompt(Combat)] You are dead and can no longer regenerate.%r
&CMD`BARRIER #446=$+Barrier *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert lte(words(%1),3)={ @pemit %#=%r[prompt(Combat)] You cannot protect that many people.%r};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Barrier,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Barrier Special Action.};@break !match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@dolist/inline %1={@assert nearby([get(%l/list`players)],[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@dolist/inline %1={@assert match([get(%l/list`players)],[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the the order. %r}};@break match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@break or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@break [u(#253/func`resourcecheck,%0,%1,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@break gte(get(%#/Dat`AP`Current),add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),4))={@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%#,Dat`DR:[ceil(mul(get(%#/Dat`DR),.5))])][u(#253/func`BarrierDur,[edit(%0,%b,-)],[words(%1)])][u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,4,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,4)])];@dolist [repeat(%1%b,[ladd(iter(%1, [words([get(%l/attacks`[locate(%#, ##, nP)])])]))])]={ [u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`BarrierEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`[locate(%#, ##, nP)]),2,1,:)])][set(%L,Attacks`[locate(%#, ##, nP)]:[ldelete(get(%L/Attacks`[locate(%#, ##, nP)]),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]}%r;@cemit monitor-combat=[r(blah)]};@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform [caplist(%0)]. %r};@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0)].%r};@pemit %#=%r[prompt(Combat)] [caplist(%0)] is not a Defensive Jutsu.}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against. }; @pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.
&CMD`DISRUPT #446=$+Disrupt *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Disrupt,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Disrupt Special Action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform [caplist(%0)].%r};@assert gte(get(%#/Dat`AP`Current),max(add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/func`formmod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)][if(gt(words(%1),1),3,2)])),1))={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])] ;@dolist/inline %1={@eval [u(#253/func`InitiateCheck,##)][set(%#,Dat`AR:[ceil(mul(u(#253/func`attackroll,%0),1))])][set(%#,Dat`Damage:[ceil(mul(u(#253/func`damageroll,%0),.2))])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:1:Disrupt,^)])][u(#253/func`DisruptEmit,%0,##)][u(#253/Func`Status)]}
&CMD`GENDEFENSE #446=$+GenDefense *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert hasattr(%L/Attacks`%#)={@pemit %#=%r[prompt(Combat)] There are no attacks to defend against.};@assert and(or(match(get(%#/Dat`ExpertiseList),Martial Arts*,|),match(get(%#/Dat`ExpertiseList),Armament*,|),match(get(%#/Dat`ExpertiseList),Nature Transformation:*,|),match(get(%#/Dat`ExpertiseList),Combination Element:*,|),match(get(%#/Dat`ExpertiseList),Seal Manifestation*,|)), match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|))={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@assert match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@pemit %#=%r[prompt(Combat)] [caplist(%0,,,L)] is not a Defensive Jutsu.};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Gendefense varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],,2)])];@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])] [setq(1,[add([u(#253/func`MentalCheck,%#)],[if(match(extract(get([iter([extract(get(%L/Attacks`%#),1,1,:)], [locate(%#, ##, nP)])]/Dat`Link),3,1,|),%#,|),ceil(mul([extract(get([pmatch(extract(get(%L/Attacks`%#),1,1,:))]/Dat`Link),1,1,|)],.25)),0)])])][setq(2,[u(#253/func`MentalCheck,[pmatch(extract(get(%L/Attacks`%#),1,1,:))])])][if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your Gendefense [sqlite_query(Game, Select Archetype From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])][if(match(extract(get([pmatch(extract(get(%L/Attacks`%#),1,1,:))]/Dat`Link),3,1,|),%#,|),%benhanced by your [extract(get([pmatch(extract(get(%L/Attacks`%#),1,1,:))]/Dat`Link),4,1,|)] Link,)] has been successful!)][set(%#,Dat`DR:[add(get(%#/Dat`DR),sub(%q1,%q2))])],[remit(%L,%r[prompt(Combat)] %N fails to perform a Gen[sqlite_query(Game, Select Archetype From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])].)][set(%#,Dat`DR:[max(add(Get(%#/Dat`DR),sub(%q1,%q2)),0)])])][u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`DefenseEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]%r;@cemit monitor-combat=[r(blah)]
&CMD`TURTLE #446=$+Turtle *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Turtle,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Turtle Special Action.};@break !match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@break match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@break or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@break [u(#253/func`TurtleResourceCheck,%0)]={@break gte(get(%#/Dat`AP`Current),ceil(mul(add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)],4),sub(1,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])]))))={@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][u(#253/func`TurtleResources,[edit(%0,%b,-)])][set(%#,Dat`Dr:[ceil(mul(get(%#/Dat`DR),.6))])];@dolist/delim ^ [u(%L/Attacks`%#)]={ [u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`TurtleEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]}%r;@cemit monitor-combat=[r(blah)]};@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform a turtle variation of [caplist(%0,,,L)]. %r};@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].%r};@pemit %#=%r[prompt(Combat)] [caplist(%0,,,L)] is not a Defensive Jutsu.}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against. }; @pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.
&CMD`TAGCREATE #446=$+Tag/Create *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert lt([extract(get(%#/Dat`TagInv),2,1,|)],[extract(get(%#/Dat`TagInv),1,1,|)])={@pemit %#=[prompt(Game)] You already have the maximum amount of Tags that you can carry.}; @assert match(get(%#/Dat`ExpertiseList),Calligraphy Conjuration*,|)={@pemit %#=[prompt(Game)] You do not have the Calligraphy Conjuration Specialty and thus cannot create Tags. };@assert match(Damage|Drain|Disrupt,%0,|)={[Prompt(Game)] You must choose whether the Tag is meant to Damage, Drain, or Disrupt the target.};@assert [if(match(Drain|Disrupt,%0,|),or(match(get(%#/Dat`ExpertiseList),Disruption*,|),match(get(%#/Dat`ExpertiseList),Chakra Drain*,|)),1]={[Prompt(Game)] You do not have the training to create a [caplist(%0)] Tag.};@assert gte(get(%#/Dat`Stamina`Current),200)={@pemit %#=[prompt(Game)] You do not have enough Stamina to create the [caplist(%0,,,L)] Tag.}; @assert gte(get(%#/Dat`Chakra`Current),500)={@pemit %#=[prompt(Game)] You do not have enough Chakra to create the [caplist(%0,,,L)] Tag.}; @assert [if([member([get(%l/list`players)],%#)],gte(get(%#/Dat`AP`Current),3),1)]={@pemit %#=[prompt(Game)] You do not have enough AP to create the [caplist(%0,,,L)] Tag.}; @set %#=Dat`TagInv:[replace(get(%#/dat`TagInv),2,[add([extract(get(%#/Dat`TagInv),2,1,|)],1)],|)]; @set %#=Dat`TagInv:[insert(get(%#/dat`TagInv),-1,[caplist(%0,,,L)],|)]; @set %#=Dat`Stamina`Current:[sub(get(%#/Dat`Stamina`Current),200)]; @set %#=Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),500)];@eval [if([member([get(%l/list`players)],%#)],[set(%#,Dat`AP`Current:[sub(get(%#/Dat`AP`Current),3)])])];@pemit %#=[prompt(Game)] You have successfully created a [caplist(%0,,,L)] Tag!; @remit %L=[prompt(Game)] %N has successfully created a Tag!
&CMD`TAG #446=$+Tag */*=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%2, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of using tags against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={ @pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([extract(get(%#/Dat`TagInv),3,10,|)],%0,|)={@pemit %#=%r[prompt(Combat)] You do not possess [caplist(%0)] Tags.};@assert lte(words(%2),3)={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert match(extract(get(%#/Dat`TagInv),3,10,|),%0,|)={@pemit %#=[Prompt(Combat)] You do not have [caplist(%0)] Tags in your inventory.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert gte(get(%#/Dat`Stamina`Current),50)={@pemit %#=[prompt(Game)] You do not have enough Stamina to use the [caplist(%1,,,L)] Tag.}; @assert gte(get(%#/Dat`Chakra`Current),200)={@pemit %#=[prompt(Game)] You do not have enough Chakra to prime the [caplist(%1,,,L)] Tag.};@assert gte(get(%#/Dat`AP`Current),add(2,[if(eq([extract(get(%#/Dat`Link),2,1,|)],1),1)],[if(gt(words(%2),1),2,0)]))={@pemit %#=[Prompt(Combat)] You do not have enough AP to unseal the [caplist(%1)] Tag.%r};@dolist/inline [iter(%2, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}}; @set %#=Dat`Stamina`Current:[sub(get(%#/Dat`Stamina`Current),50)]; @set %#=Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),200)];@set %#=Dat`AP`Current:[sub(get(%#/Dat`AP`Current),add(2,[if(eq([extract(get(%#/Dat`Link),2,1,|)],1),1)],[if(gt(words(%2),1),2,0)]))];@dolist/inline %2={@eval [u(#253/func`InitiateCheck,##)][u(#253/func`TagEmit,%1,##,[caplist(%0,,,L)])][pemit(%#,[prompt(Combat)] You have used a [caplist(%1,,,L)] Tag. You now have [sub([extract(get(%#/Dat`TagInv),2,1,|)],1)] Tags remaining.)][set(%#,Dat`TagInv:[replace(get(%#/dat`TagInv),2,[sub([extract(get(%#/Dat`TagInv),2,1,|)],1)],|)])][set(%#,Dat`TagInv:[remove(get(%#/dat`TagInv),[caplist(%0,,,L)],|)])][u(#253/Func`Status)]}
&CMD`AVOID #446=$+Avoid *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Avoid,~)={ @pemit %#=%r[prompt(Combat)] The %0 jutsu isn't capable of utilizing the Avoid Special Action.};@break !match(Distract Link Exhaust,[extract(get(%L/Attacks`%#),7,1,:)])={@break hasattr(%L/Attacks`%#)={@break eq([get(%l/player_turn)],[member([get(%l/list`players)], %#)])={@break match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Defend,:)={@break or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@break [u(#253/func`AvoidResourceCheck,%0)]={@break gte(get(%#/Dat`AP`Current),ceil(add([sqlite_query(Game, Select AP From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],add([u(#253/Func`FormMod,[edit(%0,%b,-)])],[if([extract(get(%#/Dat`Link),2,1,|)],1)]),mul(4,sub(1,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])))))={@eval [u(#253/func`defenseroll,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%#,Dat`DR:[ceil(mul(get(%#/Dat`DR),1.5))])][u(#253/func`AvoidResources,[edit(%0,%b,-)])];@dolist/delim ^ [u(%L/Attacks`%#)]={ [u(#253/Func`Ambush,[extract(get(%L/Attacks`%#),1,1,:)])][u(#253/func`AvoidEmit,[edit(%0,%b,-)],[extract(get(%L/Attacks`%#),2,1,:)])][set(%L,Attacks`%#:[ldelete(get(%L/Attacks`%#),1,^)])][u(#253/func`DefendPrompt,%#)][u(#253/func`status)]}%r;@cemit monitor-combat=[r(blah)]};@pemit %#=%r[prompt(Combat)] You do not have enough AP. %r};@pemit %#=%r[prompt(Combat)] You do not have enough resources to perform an Avoid variation of [caplist(%0,,,L)]. %r};@pemit %#=%r[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].%r};@pemit %#=%r[prompt(Combat)] [caplist(%0,,,L)] is not a Defensive Jutsu.}; @pemit %#=%r[prompt(Combat)] It is not your turn.%r}; @pemit %#=%r[prompt(Combat)] There are no attacks to defend against. }; @pemit %#=%r[prompt(Combat)] You cannot defend against Genjutsu with this command. Either use Genjutsu against Genjutsu as a counter, or Tense.
&SECS_#446 #446=1496037986
&CMD`TRAPSET #446=$+trap/* *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of setting off a trap against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%1,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%1,-,%b)]),match(Tag,%0))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@assert match(get(%#/Dat`ExpertiseList),Strategist*,|)={@pemit %#=[prompt(Combat)] You do not have the Strategist Specialty and thus are unable to utilize Traps.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert or([u(#253/func`resourcecheck,%1,%1,1)],[if(match(Tag,%0),and(gte(get(%#/Dat`Stamina`Current),50),gte(get(%#/Dat`Chakra`Current),200)))])={@pemit %#=[Prompt(Combat)] You do not have the resources to set [caplist(%1,,,L)] as a Trap.%r};@assert or(gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%1,%b,-)],%1,0)]),[if(match(Tag,%0),gte(get(%#/Dat`AP`Current),add(2,[if([extract(get(%#/Dat`Link),2,1,|)],1)])))])={@pemit %#=[Prompt(Combat)] You do not have enough AP to set [caplist(%1,,,L)] as a Trap.%r};@eval [if(match(Tag,%0),[set(%#,Dat`Stamina`Current:[sub(get(%#/Dat`Stamina`Current),50)])][set(%#,Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),200)])][set(%#,Dat`AP`Current:[sub(get(%#/Dat`AP`Current),add(2,[if([extract(get(%#/Dat`Link),2,1,|)],1)]))])],[u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,1)],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,0)])])] ;@dolist/inline [get(%L/List`Players)]={@eval [setq(1,[u(#253/func`StealthCheck,%#,Taijutsu)])][setq(2,[u(#253/func`PerceptionCheck,[locate(%#, ##, nP)])])] [if(gte(%q1,%q2),[if(match(Tag,%0),[set(%L,Traps`[locate(%#, ##, nP)]:[insert([get(%L/Traps`[locate(%#, ##, nP)])],-1,%#:Tag:##:[rand([ceil(mul(mul(add([extract(get(%#/Dat`Primarystats),1,1,|)],[extract(get(%#/Dat`TranscendAttribs),1,1,|)],[if(match(get(%#/Dat`ExpertiseList),Martial Arts*,|),10,0)],[if(match(get(%#/Dat`ExpertiseList),Armament*,|),10,0)]),3),.6))],[ceil(mul(add([extract(get(%#/Dat`Primarystats),1,1,|)],[extract(get(%#/Dat`TranscendAttribs),1,1,|)],[if(match(get(%#/Dat`ExpertiseList),Martial Arts*,|),10,0)],[if(match(get(%#/Dat`ExpertiseList),Armament*,|),10,0)]),3))])]:[switch(%1,Damage,2500,Drain,1000,Disrupt,500)]:Tag,^)])],[set(%#,Dat`AR:[u(#253/func`attackroll,%1)])][set(%#,Dat`Damage:[u(#253/func`damageroll,%1)])][set(%L,Traps`[locate(%#, ##, nP)]:[insert([get(%L/Traps`[locate(%#, ##, nP)])],-1,%#:%1:##:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:0:%0,^)])])][pemit(%#,[prompt(Combat)] You have successfully set a trap that is hidden from [name(*##)]!)],[pemit(%#,[prompt(Combat)] You have failed to set a trap that is hidden from [name(*##)].)][pemit(##,[prompt(Combat)] %N has failed to hide a trap from you.)])]
&CMD`EASSAULT #446=$+Assault *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%0, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert if(match(get(%#/Dat`Clan),Hyuuga),if(match(get(%#/Dat`TF),Byakugan),1,0),1)={@pemit %#=[prompt(Combat)] You must have Byakugan activated in order to perform Juuken.};@assert nearby(%#,[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=[prompt(Game)] The character you are trying to Assault is not present in the room.};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Escalating Assault,|)={@pemit %#=[prompt(Combat)] You do not have the appropriate Specialty needed to Assault.};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%0, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%0)] is no where to be found.};@assert gte(get(%#/Dat`AP`Current),6)={@pemit %#=[prompt(Combat)] You do not have enough AP to perform an Escalating Assault.};@assert [if(match(get(%#/Dat`Clan),Hyuuga),and(gte(get(%#/Dat`Stamina`Current),2000),gte(get(%#/Dat`Chakra`Current),660)),if(match(get(%#/Dat`Clan),Aburame),and(gte(get(%#/Dat`Stamina`Current),660),gte(get(%#/Dat`Chakra`Current),2000)),and(gte(get(%#/Dat`Stamina`Current),1330),gte(get(%#/Dat`Chakra`Current),1330))))]={@pemit %#=[prompt(Combat)] You do not have enough resources to perform an Escalating Assault.};@eval [setq(0,[rand(0,min(7,add(4,ceil(mul(get(%#/Dat`Tier),.5)))))])] [if(match(get(%#/Dat`Clan),Hyuuga),[set(%#,Dat`Stamina`Current:[max(0,sub(get(%#/Dat`Stamina`Current),2000))])][set(%#,Dat`Chakra`Current:[max(0,sub(get(%#/Dat`Chakra`Current),660))])][set(%#,Dat`AP`Current:[max(0,sub(get(%#/Dat`AP`Current),6))])],[if(match(get(%#/Dat`Clan),Aburame),[set(%#,Dat`Stamina`Current:[max(0,sub(get(%#/Dat`Stamina`Current),660))])][set(%#,Dat`Chakra`Current:[max(0,sub(get(%#/Dat`Chakra`Current),2000))])][set(%#,Dat`AP`Current:[max(0,sub(get(%#/Dat`AP`Current),6))])],[set(%#,Dat`Stamina`Current:[max(0,sub(get(%#/Dat`Stamina`Current),1330))])][set(%#,Dat`Chakra`Current:[max(0,sub(get(%#/Dat`Chakra`Current),1330))])])])][set(%#,Dat`AP`Current:[max(0,sub(get(%#/Dat`AP`Current),6))])] ;@dolist/inline [iter(%0, [locate(%#, ##, nP)])]={@eval [u(#253/func`InitiateCheck,##)][setq(1,[rand(ceil(mul([u(#245/Func`EAssaultChallenge,%#)],.5)),[u(#245/Func`EAssaultChallenge,%#)])])][setq(2,[rand(ceil(mul([u(#245/Func`EAssaultChallenge,##)],.25)),[u(#245/Func`EAssaultChallenge,##)])])] ;@skip/ifelse [gt(%q1,%q2)]={@eval [remit(%L,[prompt(Combat)] %N successfully moves in to position to begin their Escalating Assault\(%q1\) against [name(*[locate(%#, %0, nP)])]\(%q2\)! )] [if(gt(%q0,0),[u(#253/Func`EAssaultEmit,##,%q0)],[remit(%L,[prompt(Combat)] %N fails to initiate their Escalating Assault!)])]},{@remit %L=[prompt(Combat)] %N finds [obj(%#)]self unable to land any of the attacks of their Escalating Assault(%q1) as [name(*[locate(%#, %0, nP)])] defends(%q2) against [obj(%#)]!}}; @eval [u(#253/Func`Status)]
&CMD`COLLAB #446=$+Collab *=*/*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You incapable of collaborating against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Collab,~)={@pemit %#=[Prompt(Combat)] [caplist(%0,,,L)] is not capable of performing the Collab Special Action.};@assert or(hasattr(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,-,%b)]))={@pemit %#=[Prompt(Combat)] You do not know how to perform [caplist(%0,,,L)].};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@dolist/inline %2={@assert match([sqlite_query(Game, Select Special from Templates where ID="[extract(get([locate(%#, ##, nP)]/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)]")],Collab,~)={@pemit %#=[Prompt(Combat)] ##'s [caplist(%0,,,L)] is not capable of performing the Collab Special Action.}};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,[if(match(get(%#/Dat`ExpertiseList),Multi Target*,|),add(2,[switch(after(extract(get(%#/Dat`Expertiselist),match(get(%#/Dat`ExpertiseList),Multi Target*,|),1,|),^),0,0,1,2,2,8)]),0)],Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),add(2,[switch(after(extract(get(%#/Dat`Expertiselist),match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),1,|),^),0,0,1,2,2,8)]),0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert lte(words(%2),[if(match(get(%#/Dat`ExpertiseList),Synchronized Effort*,|),[switch(after(extract(get(%#/Dat`Expertiselist),match(get(%#/Dat`ExpertiseList),Synchronized Effort*,|),1,|),^),0,2,1,3,2,4)],0)])={@pemit %#=%r[prompt(Combat)] You cannot collaborate with more than [switch(after(extract(get(%#/Dat`Expertiselist),match(get(%#/Dat`ExpertiseList),Synchronized Effort*,|),1,|),^),0,2,1,3,2,4)] people at once.};@assert [u(#253/func`resourcecheck,%0,%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform a Collab varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,5)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[Locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] The target is not in the same area as you. %r}};@dolist/inline %2={@assert hasattr([locate(%#, ##, nP)]/Dat`JutsuAttributes`[edit(%0,%b,-)])={@pemit %#=[prompt(Game)] [name([locate(%#, ##, nP)])] does not possess the [caplist(%0,,,L)] jutsu.}};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%1,2,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,5)])] ;@dolist/inline %1={@eval [u(#253/func`InitiateCheck,##)]};@dolist/inline %2={@eval [set(%#,Dat`AR:[u(#253/func`attackroll,%0)])][set(%#,Dat`Damage:[u(#253/func`damageroll,%0)])][set(%L,Dat`Collab:%#:%0:[setinter(%1,%1)]:[get(%#/Dat`AR)]:[get(%#/Dat`Damage)]:[setinter([name(*##)],[name(*##)])]:)][u(#253/func`CollabEmit,%0,%1,##)]};@dolist/inline [setinter(%2,%2)]={@eval [t([setq(0,[iter(%2, [locate(%#, ##, nP)])])])];@pemit %#=[prompt(Game)] You have initated a collaborative jutsu requiring [ansi(y, [if(gte(words([setinter(%2,%2)]),2),[insert([setinter(%2,%2)],-2,and)],[setinter(%2,%2)])])] to participate in the execution of the [caplist(%0,,,L)] jutsu.;@pemit [locate(%#, ##, nP)]=[prompt(Game)] [ansi(c, %N)] wants to collaborate with you in executing thier [ansi(hy,caplist(%0,,,L))] Jutsu. %r%r Type [ansi(hg, +collab/accept)] or [ansi(hg, +collab/decline)] to accept or decline the jutsu collaboration.};@eval [u(#253/Func`Status)]
&CMD`COLLAB-RESPONSE #446=$^\+collab/(accept|decline)$:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break [strmatch(%1, decline)]={@pemit %#=[prompt(Game)] You have [ansi(r, declined)] to collaborate with [ansi(c, [name([extract(get(%L/Dat`Collab),1,1,:)])])]'s [extract(get(%L/Dat`Collab),2,1,:)] jutsu.;@Remit %L=[prompt(Game)] [ansi(y, %N)] has [ansi(r, declined)] to collaborate with [name([extract(get(%L/Dat`Collab),1,1,:)])]'s [extract(get(%L/Dat`Collab),2,1,:)] jutsu and thus it cannot be compelted!;&dat`Collab %L=};@assert match(extract(get(%L/Dat`Collab),6,1,:),%N)={@pemit %#=[prompt(Game)] No one is attempting to collaborate with you in performing a jutsu.};@assert [u(#253/func`resourcecheck,[extract(get(%L/Dat`Collab),2,1,:)],[extract(get(%L/Dat`Collab),3,1,:)],2,[u(#253/func`adaptabilitymod,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)])])]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform a Collaborative varient of [extract(get(%L/Dat`Collab),2,1,:)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)],[extract(get(%L/Dat`Collab),3,1,:)],6)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [extract(get(%L/Dat`Collab),2,1,:)].%r};@break [strmatch(%1, accept)]={@pemit [extract(get(%L/Dat`Collab),1,1,:)]=[prompt(Game)] [ansi(y, [cname(%#)])] has agreed to collaborate with you in performing the [extract(get(%L/Dat`Collab),2,1,:)] jutsu.;@pemit %#=[prompt(Game)] You have agreed to collaborate in performing [ansi(c,name([extract(get(%L/Dat`Collab),1,1,:)]))]'s [extract(get(%L/Dat`Collab),2,1,:)] jutsu, adding your jutsu prowess to their own!; @eval [set(%#,Dat`AR:[u(#253/func`attackroll,[extract(get(%L/Dat`Collab),2,1,:)])])][set(%#,Dat`Damage:[u(#253/func`damageroll,[extract(get(%L/Dat`Collab),2,1,:)])])];@set %L=dat`Collab:[replace(get(%L/Dat`Collab),4,[add(get(%#/Dat`AR),[extract(get(%L/Dat`Collab),4,1,:)])],:)];@set %L=dat`Collab:[replace(get(%L/Dat`Collab),5,[add(get(%#/Dat`Damage),[extract(get(%L/Dat`Collab),5,1,:)])],:)];@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)],[extract(get(%L/Dat`Collab),3,1,:)],2,[u(#253/func`adaptabilitymod,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)])])],[u(#253/Func`CombatChakra,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)],[extract(get(%L/Dat`Collab),3,1,:)],2,[u(#253/func`adaptabilitymod,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)])])],[u(#253/Func`CombatAP,[edit([extract(get(%L/Dat`Collab),2,1,:)],%b,-)],[extract(get(%L/Dat`Collab),3,1,:)],6)])] [remit(%L,[prompt(Combat)] %N Collaborates with [name(extract(get(%L/Dat`Collab),1,1,:))] in performing the [extract(get(%L/Dat`Collab),2,1,:)] jutsu!)] [set(%L,Dat`Collab:[remove(get(%L/Dat`Collab),[name(%#)],:)])] [if(lte(words([extract(get(%L/Dat`Collab),6,1,:)]),0),[remit(%L,[prompt(Combat)] With the collaborative efforts to perform and amplify the jutsu complete%, [insert([extract(get(%L/Dat`Collab),3,1,:)],-2,and)] are attacked with [extract(get(%L/Dat`Collab),2,1,:)]([ceil(mul(extract(get(%L/Dat`Collab),4,1,:),.7))])! )])];@dolist/inline [extract(get(%L/Dat`Collab),3,1,:)]={@set %L=Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,[extract(get(%L/Dat`Collab),1,1,:)]:[extract(get(%L/Dat`Collab),2,1,:)]:##:[ceil(mul(extract(get(%L/Dat`Collab),4,1,:),.7))]:[ceil(mul(extract(get(%L/Dat`Collab),5,1,:),.8))]:0,^)]};@eval if(eq(words([extract(get(%L/Dat`Collab),6,1,:)]),0),[set(%L,Dat`Collab:)])}
@set #446/CMD`COLLAB-RESPONSE = regexp
&CMD`REVEAL #446=$+reveal *:@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=[prompt(Combat)] You are dead and can no longer reveal others.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=[prompt(Combat)] It is not your turn.%r};@assert gte(get(%#/Dat`AP`Current),1)={@pemit %#=[Prompt(Combat)] You do not have enough AP to reveal anyone.%r};@break match([extract(get(%#/Dat`PerceptionCheck),3,1,|)],[iter(%0, [locate(%#, ##, nP)])],|)={@pemit %#=[prompt(Combat)] You are unable to locate [name(*%0)].};@remit %L=[prompt(Combat)] %N gives away [name(*%0)]'s position!;@set %#=Dat`AP`Current:[sub(get(%#/Dat`AP`Current),1)];@dolist/inline [remove(lcon(%L/connect),%#)]={@Eval [if(match([extract(get(##/Dat`PerceptionCheck),3,1,|)],[locate(%#, %0, nP)],|),[set(##,Dat`PerceptionCheck:)][pemit(##,[prompt(Combat)] [name(*%0)] has been revealed to you.)])]}[u(#253/func`status)]
&CMD`INTERCEPT #446=$+Intercept *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You are incapable of intercepting a Jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert hasattr(%L/Attacks`[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] There are no attacks to defend against.};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r[prompt(Combat)] You are not in order.%r};@assert eq(words(extract(get(%L/Attacks`[iter(%0, [locate(%#, ##, nP)])]),%1,1,^)),1)={@pemit %#=%r[prompt(Combat)] Attack number %1 does not exist against [name(*%0)].};@assert gte(get(%#/Dat`AP`Current),6)={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform an Interception.%r};@assert gte(get(%#/Dat`Stamina`Current),ceil(mul(get(%#/Dat`Stamina`Max),.05)))={};@assert isnum(%1)={@pemit %#=[Prompt(Combat)] %1 is not a correct number for the attack to be Intercepted.};@eval [u(#253/func`InterceptEmit,%0,%1)] [set(%L,Attacks`[iter(%0, [locate(%#, ##, nP)])]:[ldelete(get(%L/Attacks`[iter(%0, [locate(%#, ##, nP)])]),%1,^)])][set(%#,Dat`AP`Current:[max(0,sub(get(%#/Dat`AP`Current),6))])][set(%#,Dat`Stamina`Current:[max(0,sub(get(%#/Dat`Stamina`Current),ceil(mul(get(%#/Dat`Stamina`Max),.05))))])][u(#253/func`DefendPrompt)][u(#253/func`status)] %r;@cemit monitor-combat=[r(blah)]
&CMD`CONTROL #446=$+Control *:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break match(%#,[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You are incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Control others.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert match(loc(%#),loc(*%0))={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Control,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. %r};@assert !hasattr([iter(%0, [locate(%#, ##, nP)])]/Dat`Control)={@pemit %#=%r[prompt(Combat)] [name(*%0)] is already under [if(match(extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),1,1,|),%#),your,someone's)] Control.};@assert gte(get(%#/Dat`AP`Current),6)={@pemit %#=[prompt(Combat)] You do not have enough AP to perform Control.};@assert [if(match(get(%#/Dat`Clan),Nara),gte(get(%#/Dat`Chakra`Current),7500),if(match(get(%#/Dat`Clan),Yamanaka),gte(get(%#/Dat`Chakra`Current),10000),gte(get(%#/Dat`Chakra`Current),5000)))]={@pemit %#=[prompt(Combat)] You do not have enough Chakra to perform Control.}; @dolist/inline %0={@eval [u(#253/func`InitiateCheck,##)] }; @eval [switch(1,[match(get(%#/Dat`Clan),Nara)],[set(%#,Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),7500)])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])],[match(get(%#/Dat`Clan),Yamanaka)],[set(%#,Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),10000)])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])],[and(!match(get(%#/Dat`Clan),Nara),!match(get(%#/Dat`Clan),Yamanaka))],[set(%#,Dat`Chakra`Current:[sub(get(%#/Dat`Chakra`Current),5000)])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])])];@IF and([match(get(%#/Dat`ExpertiseList),Control*,|)],[match(get(%#/Dat`Clan),Nara)])={@eval [if(gte([u(#253/func`StealthCheck,%#,Ninjutsu)],[u(#253/func`PerceptionCheck,[iter(%0, [locate(%#, ##, nP)])])]),[set([iter(%0, [locate(%#, ##, nP)])],Dat`Control:%#|Nara)][remit(%L,[prompt(Combat)] %N extends their shadow%, cleverly weaving and winding it through the area until it makes contact with [name(*%0)]'s shadow%, capturing them with the Hiden Jutsu: Shadow Imitation Technique!)],[remit(%L,[prompt(Combat)] Despite %N's efforts%, they are unable to capture [name(*%0)] with the Hiden Jutsu: Shadow Imitation Technique.)])] [u(#253/Func`Status)]};@IF and([match(get(%#/Dat`ExpertiseList),Control*,|)],[match(get(%#/Dat`Clan),Yamanaka)])={@eval [if(and(gte([u(#253/func`StealthCheck,%#,Ninjutsu)],[u(#253/func`PerceptionCheck,[iter(%0, [locate(%#, ##, nP)])])]),gte([u(#253/func`MentalCheck,%#)],[u(#253/func`MentalCheck,[iter(%0, [locate(%#, ##, nP)])])])) ,[set([iter(%0, [locate(%#, ##, nP)])],Dat`Control:%#|Yamanaka)][set(%#,Dat`Exposure:[iter(%0, [locate(%#, ##, nP)])]|3)][remit(%L,[prompt(Combat)] %N forms the tell tale hand sign for the Hiden Jutsu: Mind Body Switch Technique%, lining up their target and projecting their consciousness in to [name(*%0)]'s body successfully!)],[remit(%L,[prompt(Combat)] %N forms the tell tale hand sign for the Hiden Jutsu: Mind Body Switch Technique%, lining up their target and projecting their consciousness towards [name(*%0)]%, but they fail to make contact which leaves them exposed!)][set(%#,Dat`Exposure:[iter(%0, [locate(%#, ##, nP)])]|3)])] [u(#253/Func`Status)] };@IF and([match(get(%#/Dat`ExpertiseList),Control*,|)],[!match(get(%#/Dat`Clan),Yamanaka)],[!match(get(%#/Dat`Clan),Nara)])={@eval [if(gte([u(#253/func`MentalCheck,%#)],[u(#253/func`MentalCheck,[iter(%0, [locate(%#, ##, nP)])])]),[set([iter(%0, [locate(%#, ##, nP)])],Dat`Control:%#|General)][switch(1,[match(get(%#/Dat`TF),Sharingan)],[remit(%L,[prompt(Combat)] %N's sharingan seems to flare upon [name(*%0)] intensely%, suddenly taking influence over their mind.)],[match(get(%#/Dat`TF),Kokuuzou)],[remit(%L,[prompt(Combat)] %N's void-like gaze seems to draw [name(*%0)]'s mind in to nothingness influence is taken over their physical form.)],[nor([match(get(%#/Dat`TF),Sharingan)],[match(get(%#/Dat`TF),Kokuuzou)])],[remit(%L,[prompt(Combat)] %N imposes their will upon [name(*%0)]%, seizing influence over their mind.)])],[remit(%L,[prompt(Combat)] %N attempts to seize control over [name(*%0)]'s mind%, but they ultimately fail.)])] [u(#253/Func`Status)] }
&CMD`RESIST #446=$+Resist:@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Resist others.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r[prompt(Combat)] You are not in order.};@assert gt(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.1)),2500)])={@pemit %#=%r[prompt(Combat)] You do not have enough Chakra to Resist the control over you.};@assert hasattr(%#/Dat`Control)={@remit %L=[prompt(Combat)] %N appears to be straining themselves very hard for some entirely unexplainable reason.%r; @set %#=Dat`Chakra`Current:[max([sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.1)),2500)])],0)] ; @Eval [u(#253/Func`Status)]}; @assert eq([get(%L/player_turn)], [member([get(%L/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@assert gte(get(%#/Dat`AP`Current),6)={@pemit %#=[prompt(Combat)] You do not have enough AP to perform Control.};@eval [switch(1,[match([extract(get(%#/Dat`Control),2,1,|)],Nara)],[if(gte([u(#245/Func`ChakraChallenge,%#)],[u(#245/Func`ChakraChallenge,[extract(get(%#/Dat`Control),1,1,|)])]),[remit(%L,[prompt(Combat)] %N struggles against the hold of [name([extract(get(%#/Dat`Control),1,1,|)])]'s Shadow Imitation Technique%, eventually powering through the hold and releasing themselves from the jutsu!)][set([extract(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Control),1,1,|)],Dat`Chakra`Current:[max(0,Sub(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),[max(ceil(mul(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])][set(%#,Dat`Control:)],[remit(%L,[prompt(Combat)] %N struggles against the hold that [name([extract(get(%#/Dat`Control),1,1,|)])]'s Shadow Imitation Technique has on them%, but ultimately they fail to break free.)][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])],[match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)],[if(gte([u(#245/Func`ChakraChallenge,%#)],[u(#245/Func`ChakraChallenge,[extract(get(%#/Dat`Control),1,1,|)])]),[remit(%L,[prompt(Combat)] %N struggles against the presence of [name([extract(get(%#/Dat`Control),1,1,|)])] and their Mind Body Switch%, eventually powering through the hold and releasing themselves from the jutsu!)][set([extract(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Control),1,1,|)],Dat`Chakra`Current:[max(0,Sub(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),[max(ceil(mul(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])][wipe([extract(get(%#/Dat`Control),1,1,|)]/Dat`Exposure)][set(%#,Dat`Control:)],[remit(%L,[prompt(Combat)] %N struggles against the hold that [name([extract(get(%#/Dat`Control),1,1,|)])]'s Mind Body Switch has on them%, but ultimately they fail to break free.)][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])])],[match([extract(get(%#/Dat`Control),2,1,|)],General)],[if(gte([u(#245/Func`ChakraChallenge,%#)],[u(#245/Func`ChakraChallenge,[extract(get(%#/Dat`Control),1,1,|)])]),[remit(%L,[prompt(Combat)] %N struggles against the Control [name([extract(get(%#/Dat`Control),1,1,|)])] exudes upon them%, eventually powering through the hold and releasing themselves from the jutsu!)][set([extract(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Control),1,1,|)],Dat`Chakra`Current:[max(0,Sub(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),[max(ceil(mul(get([extract(get(%#/Dat`Control),1,1,|)]/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])][set(%#,Dat`Control:)],[remit(%L,[prompt(Combat)] %N struggles against the hold that [name([extract(get(%#/Dat`Control),1,1,|)])]'s Control has on them%, but ultimately they fail to break free.)][set(%#,Dat`AP`Current:[max(sub(get(%#/Dat`AP`Current),6),0)])][set(%#,Dat`Chakra`Current:[max(0,Sub(get(%#/Dat`Chakra`Current),[max(ceil(mul(get(%#/Dat`Chakra`Current),.01)),2500)]))])])])] [u(#253/Func`Status)]
&CMD`RELEASE #446=$+Release *:@break match(%#,[iter(%0, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You are incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Release others from Control.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert match(loc(%#),loc(*%0))={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Control,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. %r};@assert match([extract(get([iter(%0, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)={@pemit %#=%r[prompt(Combat)] [name(*%0)] is not under your Control.}; @remit %L=%r[Prompt(Combat)] %N has released [name(*%0)] from their control.;@set %#=Dat`Exposure: ;@set [iter(%0, [locate(%#, ##, nP)])]=Dat`Control:
&CMD`DISTRACT #446=$+Distract *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert and(match(get(%#/Dat`ExpertiseList),Disruption*,|), match(get(%#/Dat`ExpertiseList),Illusionary Tactics*,|))={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action.};@assert lte(words(%1),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,2,Ninjutsu,[if(match(get(%#/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer attack.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%l/player_turn)], [member([get(%l/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break if(match(extract(get(%#/Dat`PerceptionCheck),3,1,|),[iter(%1, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is no where to be found.};@assert [u(#253/func`resourcecheck,%0,%1,3)]={@pemit %#=[Prompt(Combat)] You do not have the resources to perform Distract varient of [caplist(%0,,,L)].%r};@assert gte(get(%#/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])={@pemit %#=[Prompt(Combat)] You do not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`combatresources,[u(#253/Func`CombatStamina,[edit(%0,%b,-)],%1,1.5,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatChakra,[edit(%0,%b,-)],%0,3,[u(#253/func`adaptabilitymod,[edit(%0,%b,-)])])],[u(#253/Func`CombatAP,[edit(%0,%b,-)],%1,2)])] ;@dolist/inline [iter(%1, [locate(%#, ##, nP)])]={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] Target is not in the same area as you. %r};@eval [u(#253/func`InitiateCheck,##)] [setq(1,[u(#253/func`MentalCheck,%#)])][setq(2,[u(#253/func`MentalCheck,[locate(%#, ##, nP)])])] [if(gt(%q1,%q2),[pemit(%#,%r[prompt(Combat)] Your Disracting illusion of [caplist(%0,,,L)] has been successfully initiated!%r)][set(%#,Dat`AR:[add(u(#253/func`attackroll,%0),sub(%q1,%q2))])] [set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,%#:%0:##:[get(%#/Dat`AR)]:0:%q1:Disrupt,^)])][u(#253/func`DistractEmit,%0,##)][u(#253/Func`Status)],[remit(%L,%r[prompt(Combat)] %N fails to perform the Distraction [caplist(%0,,,L)] against [caplist(##)].)])]}
&CMD`SHADOWATTACK #446=$+Shadow *=*:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. }; @break match(%#,[iter(%1, [locate(%#, ##, nP)])])={@pemit %#=%r[prompt(Combat)] You are incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer utilize Shadows against others.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert match(loc(%#),%L))={@pemit %#=%r[prompt(Combat)] That target is not in the same area as you. %r};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Control,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. %r};@assert match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)={@pemit %#=%r[prompt(Combat)] [name(*%1)] is not under your Control.};@assert and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)])={@pemit %#=[Prompt(Combat)] You do not have Shadow Imitation Technique applied to [name(*%1)].};@assert gt(get(%#/Dat`Chakra`Current),2500)={@pemit %#=%r[prompt(Combat)] You do not have enough Chakra to utilize Shadows against others.};@assert gte(get(%#/Dat`AP`Current),4)={@pemit %#=[prompt(Combat)] You do not have enough AP to perform a Shadow Manipulation attack.};@set %#=Dat`AP`Current:[max(sub(Get(%#/Dat`AP`Current),4),0)] ;@eval [setq(0,[rand([ceil(mul([mul(add([extract(get(%#/Dat`Primarystats),2,1,|)],[extract(get(%#/Dat`TranscendAttribs),2,1,|)],[extract(get(%#/Dat`Primarystats),8,1,|)],[extract(get(%#/Dat`TranscendAttribs),8,1,|)],[extract(get(%#/Dat`Primarystats),7,1,|)],[extract(get(%#/Dat`TranscendAttribs),7,1,|)]),80)],.25))],[ceil([mul(add([extract(get(%#/Dat`Primarystats),2,1,|)],[extract(get(%#/Dat`TranscendAttribs),2,1,|)],[extract(get(%#/Dat`Primarystats),8,1,|)],[extract(get(%#/Dat`TranscendAttribs),8,1,|)],[extract(get(%#/Dat`Primarystats),7,1,|)],[extract(get(%#/Dat`TranscendAttribs),7,1,|)]),80)])])])] ;@IF gte([u(#245/Func`ChakraChallenge,%#)],[u(#245/Func`ChakraChallenge,[iter(%1, [locate(%#, ##, nP)])])])={@remit %L=%r[Prompt(Combat)] %N attacks with [poss(%#)] shadow in the form of [caplist(%0,,,L)] against [name(*%1)]%, hitting them for %q0 damage!; @set [iter(%1, [locate(%#, ##, nP)])]=Dat`Vitality`Current:[max(sub(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Vitality`Current),%q0),0)]; @wait .01=@eval [u(#253/Func`Status)]},{@remit %L=%r[Prompt(Combat)] %N attacks with [poss(%#)] shadow in the form of [caplist(%0,,,L)] against [name(*%1)]%, but their resistance proves too much to do any harm.}
&CMD`MBSATTACK #446=$+MBS */*=*:@assert and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Yamanaka)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)])={@pemit %#=%r[prompt(Combat)] You are not currently in control of [name(*%1)]'s Body.};@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is activate on this target.};@break if(gte(bittype(%#),5),0,match(%#,[iter(%1, [locate(%#, ##, nP)])]))={@pemit %#=%r[prompt(Combat)] You incapable of using this jutsu against yourself.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer make your target attack.%r};@assert gt(get([iter(%1, [locate(%#, ##, nP)])]/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] They are dead and can no longer be made to attack.%r};@assert or(match([sqlite_query(Game, Select Method From Templates where ID=[extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Attack),match([sqlite_query(Game, Select Method From Templates where ID=[extract(get(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]),7,1,|)])],Attack))={@pemit %#=[prompt(Combat)] The [caplist(%0,,,L)] jutsu is not capable of Attacking.};@assert lte(words(%2),add([switch([sqlite_query(Game, Select Category From Templates where ID=[extract(get(%#/Dat`JutsuAttributes`[edit(%0,%b,-)]),7,1,|)])],Taijutsu,3,Ninjutsu,[if(match(get([iter(%1, [locate(%#, ##, nP)])]/Dat`ExpertiseList),Shape Transformation*,|),2,0)])],1))={@pemit %#=%r[prompt(Combat)] You cannot target that many opponents at once.};@assert [member([get(%L/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert eq([get(%L/player_turn)], [member([get(%L/list`players)], %#)])={@pemit %#=%r[prompt(Combat)] It is not your turn.%r};@break if(match(extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`PerceptionCheck),3,1,|),[iter(%2, [locate(%#, ##, nP)])]),1,0)={@pemit %#=%r[prompt(Combat)] [name(*%2)] is no where to be found by your controlled target: [name([iter(%1, [locate(%#, ##, nP)])])].};@dolist/inline %2={@assert nearby(%#,[locate(%#, ##, nP)])={@pemit %#=%r[prompt(Combat)] A target is not in the same area as you. %r}};@assert or(hasattr([iter(%1, [locate(%#, ##, nP)])]/Dat`JutsuAttributes`[edit(%0,%b,-)]),hasattr(%#/Dat`CopiedJutsu`[edit(%0,%b,-)]))={@pemit %#=[Prompt(Combat)] Your controlled target [name([iter(%1, [locate(%#, ##, nP)])])] does not know how to perform [caplist(%0,,,L)].};@assert [u(#253/func`Cresourcecheck,%0,%2,,%1)]={@pemit %#=[Prompt(Combat)] Your controlled target [name([iter(%1, [locate(%#, ##, nP)])])] does not have the resources to perform [caplist(%0,,,L)].%r};@assert gte(get([iter(%1, [locate(%#, ##, nP)])]/Dat`AP`Current),[u(#253/Func`CombatAP,[edit(%0,%b,-)],%2,0)])={@pemit %#=[Prompt(Combat)] Your controlled target [name([iter(%1, [locate(%#, ##, nP)])])] does not have enough AP to perform [caplist(%0,,,L)].%r};@eval [u(#253/func`ccombatresources,%1,[u(#253/Func`CCombatStamina,[edit(%0,%b,-)],%2,1,,%1)],[u(#253/Func`CCombatChakra,[edit(%0,%b,-)],%2,1,,%1)],[u(#253/Func`CCombatAP,[edit(%0,%b,-)],%2,0,%1)])] ;@dolist/inline %2={@eval [set([iter(%1, [locate(%#, ##, nP)])],Dat`AR:[u(#253/func`attackroll,%0)])][set([iter(%1, [locate(%#, ##, nP)])],Dat`Damage:[u(#253/func`damageroll,%0)])][set(%L,Attacks`[locate(%#, ##, nP)]:[insert([get(%L/Attacks`[locate(%#, ##, nP)])],-1,[iter(%1, [locate(%#, ##, nP)])]:%0:##:[get([iter(%1, [locate(%#, ##, nP)])]/Dat`AR)]:[get([iter(%1, [locate(%#, ##, nP)])]/Dat`Damage)]:0,^)])][u(#253/func`Cattackemit,%0,##,%1)][u(#253/Func`CStatus,%1)]}
&CMD`BODYMOD #446=$^\+Body ?mod$:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is active on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Bodily Modify yourself.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert match([regeditall(get(%#/dat`ExpertiseList), %\^%[012%],)],Body Mod,|)={@pemit %#=[Prompt(Combat)] %N does not have the training to attempt this action. %r};@assert !hasattr(%#/Dat`BodyMod)={@pemit %#=%r[Prompt(Combat)] You are already utilizing Body Modification.; @remit %L=[prompt(Combat)] %N suddenly appears to be flexing and grunting for no apparent reason... };@assert gte(get(%#/Dat`AP`Current),4)={@pemit %#=[prompt(Combat)] You do not have enough AP to perform Body Mod.};@assert gte(get(%#/Dat`Chakra`Current),10000)={@pemit %#=[prompt(Combat)] You do not have enough Chakra to perform Body Modification.};@set %#=Dat`BodyMod:[get(%#/Dat`Clan)];@set %#=Dat`Chakra`Current:[max(0,[sub(get(%#/dat`Chakra`Current),10000)])] ;@set %#=Dat`AP`Current:[max([sub(get(%#/Dat`AP`Current),4)],0)] ;@eval [switch([get(%#/Dat`Clan)],Akimichi,[remit(%L,[prompt(Combat)] Drawing upon [poss(%#)] Calorie Control, %N's body begins to grow and expand at their whim!)],Hozuki,[remit(%L,[prompt(Combat)] Drawing upon [poss(%#)] Hydrification Technique, %N's body begins partially liquify!)],Kaguya,[remit(%L,[prompt(Combat)] The breaking of bones and tearing of flesh can be heard as weapons or armor are prepared through Shikotsumyaku!)],Oomori,[remit(%L,[prompt(Combat)] %N's body contorts and shifts in to a more animalistic form!)],[remit(%L,[prompt(Combat)] %N's body subtly changes as they release a power hidden within their body!)])] [u(#253/Func`Status)]
@set #446/CMD`BODYMOD = regexp
&CMD`BODYMODREVERT #446=$+Bodymod Revert:@break [match([extract(get(%#/Dat`Control),2,1,|)],Yamanaka)]={@pemit %#=%r[prompt(Combat)] Your consciousness has been suppressed by that of [name([extract(get(%#/Dat`Control),1,1,|)])]. This prevents you from taking any action other than resisting or tensing. ;@remit %L=%r[Prompt(Combat)] Try as they might, the internal struggle over %N's consciousness remains futile under [name([extract(get(%#/Dat`Control),1,1,|)])]'s control. };@break hasattr(%#/Dat`Exposure)={@pemit %#=%r[prompt(Combat)] Your conciousness is no longer within your body. This prevents you from taking any actions outside of tensing. ;@remit %L=%r[Prompt(Combat)] Having projected their conciousness from their body, %N remains unconcious and exposed.};@break or([match([extract(get(%#/Dat`Control),2,1,|)],Nara)],and([match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),2,1,|)],Nara)],[match([extract(get([iter(%1, [locate(%#, ##, nP)])]/Dat`Control),1,1,|)],%#)]))={@pemit %#=%r[prompt(Combat)] You are unable to take this action while Shadow Imitation Technique is active on this target.};@assert gt(get(%#/dat`Vitality`Current),0)={@pemit %#=%r[prompt(Combat)] You are dead and can no longer Bodily Modify yourself.%r};@assert [member([get(%l/list`players)],%#)]={@pemit %#=%r%r[prompt(Combat)] You are not in order.%r};@assert hasattr(%#/Dat`BodyMod)={@pemit %#=[Prompt(Combat)] %r You are not currently utilizing Body Modification.}; @remit %L=%r[prompt(Combat)] %N has reverted their body back to its original form.; @set %#=Dat`Bodymod: ;@eval [u(#253/Func`Status)]
